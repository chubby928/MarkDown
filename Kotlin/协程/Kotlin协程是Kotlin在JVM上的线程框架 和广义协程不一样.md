Kotlin协程是Kotlin在JVM上的线程框架 和广义协程不一样



什么是协程？

处理并发方案 并发组件

协程和线程属于一个层级的概念 是不同与线程的并发方案

协程不存在线程 也不存在并行概念

**

并发 Concurrency ：

并行 Parallelism：线程安全

比如两张图片都加滤镜 ： 并发且并行

后台发请求，前台显示：并发不并行

但kotlin在JVM的协程不能避免线程安全问题 



用抢占式线程能实现Kotlin协程 但线程切换的代价会更大

Kotlin抽象组件

协程：线程池-》 线程环境

1.在这里的代码，会在这个线程环境里开始

2.挂起函数把线程切走之后，依然会回到这个线程环境

3.主线程只有一个线程，后台线程是一个线程池



#### Kotlin线程代码怎么写

- 用launch启动一个协程，指定线程环境，default一般根据你的CPU核数线程池
- 要把后台工作的函数，写成suspend函数

#### 协程额外的天然优势：性能

- 什么时候需要切线程
  -  工作比较耗时
    -   判断是否工作耗时
    - 调用者写耗时函数就用suspend修饰
  - 工作需要放在指定线程





